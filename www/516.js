"use strict";(self.webpackChunk_snort_app=self.webpackChunk_snort_app||[]).push([[516],{1516:(e,t,n)=>{n.r(t),n.d(t,{LNCWallet:()=>w});var a,s,i,r=n(4669),o=n.n(r),c=n(4978),l=n(3290),d=n(5130),u=n.n(d),h=function(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)};!function(e){e.UNKNOWN="UNKNOWN",e.IN_FLIGHT="IN_FLIGHT",e.SUCCEEDED="SUCCEEDED",e.FAILED="FAILED",e.UNRECOGNIZED="UNRECOGNIZED"}(i||(i={}));class w{constructor(e,t){a.set(this,void 0),s.set(this,u()("LNC")),function(e,t,n,a,s){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?s.call(e,n):s?s.value=n:t.set(e,n)}(this,a,new(o())({pairingPhrase:e,password:t}),"f")}canAutoLogin(){return!1}isReady(){return h(this,a,"f").isReady}static async Initialize(e){const t=new w(e);return await t.login(),t}static Empty(){return new w}setPassword(e){if(h(this,a,"f").credentials.password&&e!==h(this,a,"f").credentials.password)throw new l.lj(l.H8.GeneralError,"Password is already set, cannot update password");h(this,a,"f").credentials.password=e}createAccount(){throw new Error("Not implemented")}async getInfo(){const e=await h(this,a,"f").lnd.lightning.getInfo();return{nodePubKey:e.identityPubkey,alias:e.alias}}close(){return h(this,a,"f").isConnected&&h(this,a,"f").disconnect(),Promise.resolve(!0)}async login(e){for(e&&(this.setPassword(e),h(this,a,"f").run()),await h(this,a,"f").connect();!h(this,a,"f").isConnected;)await new Promise((e=>{setTimeout(e,100)}));return!0}async getBalance(){var e,t;const n=await h(this,a,"f").lnd.lightning.channelBalance();return h(this,s,"f").call(this,n),parseInt(null!==(e=null===(t=n.localBalance)||void 0===t?void 0:t.sat)&&void 0!==e?e:"0")}async createInvoice(e){var t;const n=await h(this,a,"f").lnd.lightning.addInvoice({memo:e.memo,value:e.amount.toString(),expiry:null===(t=e.expiry)||void 0===t?void 0:t.toString()});return(0,c.Wg)((0,l.BP)(n.paymentRequest))}async payInvoice(e){return new Promise(((t,n)=>{h(this,a,"f").lnd.router.sendPaymentV2({paymentRequest:e,timeoutSeconds:60,feeLimitSat:"100"},(e=>{h(this,s,"f").call(this,e),e.status===i.SUCCEEDED&&t({preimage:e.paymentPreimage,state:l.kd.Paid,timestamp:parseInt(e.creationTimeNs)/1e9})}),(e=>{h(this,s,"f").call(this,e),n(e)}))}))}async getInvoices(){const e=await h(this,a,"f").lnd.lightning.listPayments({maxPayments:"10",reversed:!0});return h(this,s,"f").call(this,e),e.payments.map((e=>{const t=(0,l.BP)(e.paymentRequest);if(!t)throw new l.lj(l.H8.InvalidInvoice,`Could not parse ${e.paymentRequest}`);return{...t,state:(()=>{switch(e.status){case i.SUCCEEDED:return l.kd.Paid;case i.FAILED:return l.kd.Failed;default:return l.kd.Pending}})(),preimage:e.paymentPreimage}}))}}a=new WeakMap,s=new WeakMap}}]);
//# sourceMappingURL=516.js.map